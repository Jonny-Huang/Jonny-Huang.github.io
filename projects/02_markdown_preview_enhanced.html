<hr>
<p>title: 用筆記也可以管理專案(二)：Markdown Preview Enhanced<br>date: 2017-12-12<br>categories: Projects<br>keywords:</p>
<ul>
<li>Markdown</li>
<li>Markdown Preview Enhanced<br>tags:</li>
<li>Projects</li>
</ul>
<hr>
<h1 id="Markdown"><a href="#Markdown" class="headerlink" title="Markdown"></a>Markdown</h1><p>在 <a href="/projects/01_plantuml/">用筆記也可以管理專案(一)：PlantUML</a> 中我們利用了 <a href="http://plantuml.com/">PlantUML</a> 來協助產生 UML 模型，接著文字說明的部分則採用 Markdown 文件格式(.md 檔)，讓我們可以在純文字的描述中，透過一些簡單的語法來協助我們排版，VS Code 內建也已經支援 Markdown，同時也提供預覽功能。<br><img src="/images/projects/markdown_preview_enhanced/mpe_37.png" alt="img"></p>
<blockquote>
<p>Markdown 其實是吸收了 HTML 的排版特性，它是利用一些較不影響既有內容可讀性的語法，將我們的純文字轉換成 HTML 並一它的語法結構添入適當的 HTML Tag 來讓版面美觀，上手難度並不高。相關語法可以查閱 <a href="http://markdown.tw/">Markdown 語法說明</a>。</p>
</blockquote>
<!-- more -->  

<h1 id="安裝-Markdown-Preview-Enhanced"><a href="#安裝-Markdown-Preview-Enhanced" class="headerlink" title="安裝 Markdown Preview Enhanced"></a>安裝 Markdown Preview Enhanced</h1><p>接著我們安裝 VS Code 擴充功能- <a href="https://marketplace.visualstudio.com/items?itemName=shd101wyy.markdown-preview-enhanced">Markdown Preview Enhanced</a>，利用 Markdown Preview Enhanced 強大的支援能力來彙整資料並輸出成 PDF 檔。<br><img src="/images/projects/markdown_preview_enhanced/mpe_35.png" alt="img"><br>我們可以透過快捷鍵 <code>Ctrl</code>+<code>K``V</code>來開啟檢視，亦可透過功能選單開啟。<br><img src="/images/projects/markdown_preview_enhanced/mpe_38.png" alt="img"></p>
<h1 id="import"><a href="#import" class="headerlink" title="@import"></a>@import</h1><p><strong>Markdown Preview Enhanced</strong> 相關功能可以查閱<a href="https://shd101wyy.github.io/markdown-preview-enhanced/#/zh-tw/">官方說明文件</a>，筆者僅分享自己使用過的功能。</p>
<p><code>@import</code> 可以協助我們將外部文件的資料載入到目前內容，其實還有其他載入方式，不過因為 <code>@import</code> 通用性最高，所以基於可讀性與維護性考量，我們一律透過 <code>@import</code> 來嵌入內容，透過這種方式的另一個好處就是可以將整份文件拆解成多個小文件，最後再彙整在一起，像筆者便建立一個 <strong>meeting</strong> 資料夾來存放每次會議討論或是重要的 email 內容，最後再彙整到<strong>專案記錄</strong>(readme.md)內。<br><img src="/images/projects/markdown_preview_enhanced/mpe_39.png" alt="img"><br>當然我們也可以透過 <code>@import</code> 匯入圖檔來輔助說明。<br><img src="/images/projects/markdown_preview_enhanced/mpe_40.png" alt="img"><br><img src="/images/projects/markdown_preview_enhanced/mpe_41.png" alt="img"><br>支持的文件類型如下：<br><img src="/images/projects/markdown_preview_enhanced/mpe_45.png" alt="img"></p>
<h2 id="PlantUML"><a href="#PlantUML" class="headerlink" title="PlantUML"></a>PlantUML</h2><p>{% blockquote Markdown Preview Enhanced <a href="https://shd101wyy.github.io/markdown-preview-enhanced/#/zh-tw/diagrams">https://shd101wyy.github.io/markdown-preview-enhanced/#/zh-tw/diagrams</a> Diagrams %}<br>Markdown Preview Enhanced 內部支持 flow charts, sequence diagrams, mermaid, PlantUML, WaveDrom, GraphViz，Vega &amp; Vega-lite，Ditaa 圖像渲染。 你也可以通過使用 Code Chunk 來渲染 TikZ, Python Matplotlib, Plotly 等圖像。<br>{% endblockquote %}</p>
<p>官方範例是直接將 <a href="http://plantuml.com/">PlantUML</a> 語法寫入到目前內容。<br><img src="/images/projects/markdown_preview_enhanced/mpe_42.png" alt="img"><br>但是筆者則採用 <code>@import</code> 方式將外部 UML 模型檔(.puml)嵌入進來，這樣 UML 模型就可以獨立維護。<br><img src="/images/projects/markdown_preview_enhanced/mpe_43.png" alt="img"><br><img src="/images/projects/markdown_preview_enhanced/mpe_44.png" alt="img"></p>
<h2 id="CSV"><a href="#CSV" class="headerlink" title="CSV"></a>CSV</h2><p>雖然 Markdown 本身也有 Table 語法，但是表單式的資料大部分的人還是習慣透過像 Excel 這類的工具來編輯維護，因此依照 Markdown Preview Enhanced 所支援的檔案類型 csv 變成為首選，筆者便將 <strong>問題清單</strong>(Issue List) 透過 csv 檔來儲存與維護。<br><img src="/images/projects/markdown_preview_enhanced/mpe_47.png" alt="img"><br>要注意的是因為 Markdown 會轉換成 HTML，所以會將 csv 檔採用 UTF-8 方式編碼，但是透過 Excel 開啟預設便會出現亂碼。<br><img src="/images/projects/markdown_preview_enhanced/mpe_48.png" alt="img"><br>但是如果是透過 <a href="https://zh-tw.libreoffice.org/">LibreOffie</a> 的 Calc 開啟時，只要先指定字元集為 UTF-8 便可正常開啟與編輯。<br><img src="/images/projects/markdown_preview_enhanced/mpe_46.png" alt="img"></p>
<h3 id="安裝擴充功能：Excel-Viewer-選擇性"><a href="#安裝擴充功能：Excel-Viewer-選擇性" class="headerlink" title="安裝擴充功能：Excel Viewer (選擇性)"></a>安裝擴充功能：Excel Viewer (選擇性)</h3><p>如果會在 VS Code 上檢視 csv 內容，我們可以安裝 <a href="https://marketplace.visualstudio.com/items?itemName=GrapeCity.gc-excelviewer">Excel Viewer</a> 來協助我們更方便查閱資料， Excel Viewer 不提供編輯功能。<br><img src="/images/projects/markdown_preview_enhanced/mpe_49.png" alt="img"><br><img src="/images/projects/markdown_preview_enhanced/mpe_50.png" alt="img"><br>最後當然就是將檔案 <code>@import</code> 到專案記錄檔內。<br><img src="/images/projects/markdown_preview_enhanced/mpe_51.png" alt="img"><br><img src="/images/projects/markdown_preview_enhanced/mpe_52.png" alt="img"></p>
<h1 id="匯出-PDF"><a href="#匯出-PDF" class="headerlink" title="匯出 PDF"></a>匯出 PDF</h1><p>到目前為止整個專案紀錄檔 (readme.md) 的資料都是透過 <code>@import</code> 外部資料，也就是專案紀錄檔只要負責將專案相關人員所需檢視的資料加入即可，其實可以在會議中便及時地去維護相關文件內容，這樣就可以確保文件是最新版本而且不會有不同文件不同版本的問題。<br><img src="/images/projects/markdown_preview_enhanced/mpe_53.png" alt="img"><br>最後當然是需要將文件匯出，才能及時轉發給相關人員，我們在 Markdown Preview Enhanced 預覽畫面上開啟功能選單，可以發現 Markdown Preview Enhanced 提供了非常多個匯出格式與方法，筆者是使用較簡單的 <a href="http://phantomjs.org/">PhantomJS</a>。<br><img src="/images/projects/markdown_preview_enhanced/mpe_54.png" alt="img"><br>點選過程會發現被要求安裝 PhantomJS。<br><img src="/images/projects/markdown_preview_enhanced/mpe_55.png" alt="img"><br>到<a href="http://phantomjs.org/download.html">官方下載頁面</a>下載對應的版本，解壓縮後可以發現其實不需要安裝，筆者將它放在 <code>D:\Tools\PhantomJS\</code> 目錄下(其實只需要 bin 資料夾內的 phantomjs.exe)。<br><img src="/images/projects/markdown_preview_enhanced/mpe_56.png" alt="img"><br><img src="/images/projects/markdown_preview_enhanced/mpe_57.png" alt="img"><br>重新開啟功能選單並選擇透過 PhantomJS 匯出 pdf 檔，可以發現系統自動產生 pdf 檔並自動開啟。<br><img src="/images/projects/markdown_preview_enhanced/mpe_58.png" alt="img"></p>
<p>接著在 VS Code 的使用者設定內添加 <code>markdown-preview-enhanced.phantomPath</code> 屬性，並設定 phantomjs.exe 所在路徑即可。</p>
<h2 id="安裝擴充功能：vscode-pdf-選擇性"><a href="#安裝擴充功能：vscode-pdf-選擇性" class="headerlink" title="安裝擴充功能：vscode-pdf (選擇性)"></a>安裝擴充功能：vscode-pdf (選擇性)</h2><p>如果會在 VS Code 上檢視 pdf 內容，我們可以安裝 <a href="https://marketplace.visualstudio.com/items?itemName=tomoki1207.pdf">vscode-pdf</a>，便可在 pdf 檔透過功能選單開啟。<br><img src="/images/projects/markdown_preview_enhanced/mpe_59.png" alt="img"><br><img src="/images/projects/markdown_preview_enhanced/mpe_60.png" alt="img"></p>
<h1 id="修改樣式"><a href="#修改樣式" class="headerlink" title="修改樣式"></a>修改樣式</h1><p>Markdown Preview Enhanced 提供我們可以客製化 css 樣式，在 VS Code 內透過 <code>Ctrl</code> + <code>Shift</code> + <code>P</code> 開啟命令選擇區(或者透過上方功能列的 檢視\命令選擇區)，搜選並選擇 <strong>Markdown Preview Enhanced：Customize CSS</strong> 來開啟 <code>style.less</code>。<br><img src="/images/projects/markdown_preview_enhanced/mpe_61.png" alt="img"><br>像筆者便修改字型。<br><img src="/images/projects/markdown_preview_enhanced/mpe_62.png" alt="img"></p>
<h1 id="後記"><a href="#後記" class="headerlink" title="後記"></a>後記</h1><p>因緣巧遇之下接到一個特殊的專案，在校長兼撞鐘情狀況下折騰了一個禮拜，VS Code 又展露出它的強大，當然感謝那些默默付出的大神們，雖然匯出的檔案內容有些排版還有一些小缺失，但是並不會影響文件的閱讀性，如此低維護成本與高實質效益對於資源有限的公司來說其實是值得透入的。</p>
